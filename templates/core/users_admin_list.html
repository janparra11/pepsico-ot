{% extends "base.html" %}
{% block title %}Usuarios{% endblock %}
{% block content %}
<div class="bg-white p-3 rounded shadow-sm">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="h5 mb-0">Usuarios</h1>
    <a class="btn btn-primary btn-sm" href="{% url 'users_admin_create' %}">Nuevo usuario</a>
  </div>

  <table class="table align-middle">
    <thead>
      <tr><th>Username</th><th>Nombre</th><th>Email</th><th>Rol</th><th>Estado</th><th>Acciones</th></tr>
    </thead>
    <tbody>
      {% for u in users %}
      <tr>
        <td>{{ u.username }}</td>
        <td>{{ u.get_full_name|default:"—" }}</td>
        <td>{{ u.email|default:"—" }}</td>
        <td>{{ u.perfil.get_rol_display|default:"(sin rol)" }}</td>
        <td>
          <span class="badge {% if u.is_active %}text-bg-success{% else %}text-bg-secondary{% endif %}">
            {% if u.is_active %}Activo{% else %}Inactivo{% endif %}
          </span>
        </td>
        <td class="text-nowrap">
          <a class="btn btn-outline-secondary btn-sm" href="{% url 'users_admin_set_role' u.id %}">Rol</a>
          <a class="btn btn-outline-secondary btn-sm" href="{% url 'users_admin_toggle_active' u.id %}">Estado</a>
          <a class="btn btn-outline-danger btn-sm" href="{% url 'users_admin_reset_password' u.id %}">Reset Pass</a>
        </td>
      </tr>
      {% empty %}
      <tr><td colspan="6" class="text-muted">Sin usuarios.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
